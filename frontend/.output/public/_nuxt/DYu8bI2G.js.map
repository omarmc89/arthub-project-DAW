{"version":3,"file":"DYu8bI2G.js","sources":["../../../../pages/profile/index.vue"],"sourcesContent":["<template>\n  <section class=\"flex flex-row gap-8 mb-12\">\n    <UButton :class=\"{ 'btn-clicked': !inputBlocked, 'btn': inputBlocked}\" @click=\"inputBlockedToggle\">Edit profile</UButton>\n    <UButton class=\"btn\" @click=\"inputBlockedToggle\">Change password</UButton>\n  </section>\n  <section class=\"main-container flex flex-row\">\n      <article class=\"image-container\">\n          <img v-if=\"skeletonOff\" :src=\"avatar_image\" :alt=\"user.avatar\" />\n          <USkeleton v-if=\"!skeletonOff\" class=\"h-[350px] w-[350px]\" />\n      </article>\n      <article class=\"form-container flex flex-col justify-center items-center\">\n          <form class=\"artwork-form space-y-4 text-slate-900\" @submit.prevent=\"update\">\n                  <div>\n                      <div class=\"form-label text-center text-center\">\n                          <label for=\"first_name\">First Name</label>\n                          <input v-model=\"user.first_name\" :class=\"{ 'input-blocked': inputBlocked }\"  :readonly=\"inputBlocked\" id=\"first_name\" name=\"first_name\" type=\"text\" class=\"form-control rounded-full bg-white\">\n                      </div>\n                      <div class=\"form-label text-center\">\n                          <label for=\"last_name\">Last Name</label>\n                          <input v-model=\"user.last_name\" :class=\"{ 'input-blocked': inputBlocked }\"  :readonly=\"inputBlocked\" id=\"last_name\" name=\"last_name\" type=\"text\" class=\"form-control rounded-full bg-white\">\n                      </div>\n                      <div class=\"form-label text-center\">\n                          <label for=\"username\">Username</label>\n                          <input v-model=\"user.username\" :class=\"{ 'input-blocked': inputBlocked }\"  :readonly=\"inputBlocked\" id=\"username\" name=\"username\" type=\"text\" class=\"form-control rounded-full bg-white\">\n                      </div>\n                      <div class=\"form-label text-center\">\n                          <label for=\"avatar\">Image URL</label>\n                          <input v-model=\"user.avatar\" :class=\"{ 'input-blocked': inputBlocked }\"  :readonly=\"inputBlocked\" id=\"avatar\" name=\"avatar\" type=\"text\" class=\"form-control rounded-full bg-white\">\n                      </div>\n                      <div class=\"form-label text-center\">\n                          <label for=\"nickname\">Nickname</label>\n                          <input v-model=\"artist.nickname\" :class=\"{ 'input-blocked': inputBlocked }\"  :readonly=\"inputBlocked\" id=\"nickname\" name=\"nickname\" type=\"text\" class=\"form-control rounded-full bg-white\">\n                      </div>\n                      <div class=\"form-label text-center\">\n                          <label for=\"email\">email</label>\n                          <input v-model=\"user.email\" :class=\"{ 'input-blocked': inputBlocked }\"  :readonly=\"inputBlocked\" id=\"email\" name=\"email\" type=\"email\" class=\"form-control rounded-full bg-white\">\n                      </div>\n                  </div>\n              <button type=\"submit\" :disabled=\"pendingFetch\" class=\"btn btn-primary\">\n                  <span v-if=\"pendingFetch\">Updating...</span>\n                  <span v-else>Update</span>\n              </button>\n          </form>\n      </article>\n  </section>\n    \n</template>\n\n<script setup>\nimport { useUserLoggedData } from '@/composables/useUserLoggedData'\nimport { useAuthStore } from '~/store/auth';\n\nconst route = useRoute()\nconst toast = useToast();\nconst { userLogged } = storeToRefs(useAuthStore());\nconst pendingFetch = ref(false)\nconst avatar_image = ref('')\nconst inputBlocked = ref(true)\nconst artist = ref({\n    nickname: ''\n})\nconst user = ref({\n    first_name: '',\n    last_name: '',\n    username:'',\n    email:'',\n    password:'',\n    avatar:''\n})\n\nconst dataFetch = ref({})\nconst skeletonOff = ref(false)\nconst artistData = ref({})\n\nonBeforeMount(async() => {\n  // Llama a tu función aquí\n  artistData.value = await useUserLoggedData();\n});\n\nonMounted(async () => {\n  try {\n    artistData.value = await useUserLoggedData();\n    if (artistData.value) {\n        user.value.username = artistData.value.user.username\n        user.value.first_name = artistData.value.user.first_name\n        user.value.last_name = artistData.value.user.last_name\n        user.value.email = artistData.value.user.email\n        user.value.avatar = artistData.value.user.avatar\n        user.value.password = artistData.value.user.password\n        artist.value.nickname = artistData.value.nickname\n    }\n    checkAvatar()\n    skeletonOff.value = true\n  } catch (error) {\n    console.error('Error fetching user artworks:', error);\n  }\n});\n\nwatch(user.value, () => {\n  // Si el avatar cambia, actualiza la imagen\n  checkAvatar();\n  console.log('Avatar changed');\n});\n\nfunction checkAvatar () {\n    if (user.value.avatar.includes('http')) {\n        avatar_image.value = user.value.avatar\n    } else {\n        avatar_image.value = 'https://upload.wikimedia.org/wikipedia/commons/thumb/5/59/User-avatar.svg/1024px-User-avatar.svg.png'\n    }\n}\n\nconst update = async() => {\n  const { data, pending, error } = await useFetch(`https://arthub-api-polished-breeze-902.fly.dev/api/v1/artists/${artistData.value.id}/`, {\n    method: 'PUT',\n    headers: {\n      'Content-Type': 'application/json'\n      //'Authorization': 'Token f3b557760eda960a094698122c6eb9489c2487f3'\n    },\n    body: JSON.stringify({\n        id: userLogged.value.pk,\n        username: user.value.username,\n        email: user.value.email,\n        first_name: user.value.first_name,\n        last_name: user.value.last_name,\n        password: user.value.password,\n        avatar: user.value.avatar,\n        nickname: artist.value.nickname,\n    })\n  });\n  if (error) {\n    console.log(error.value)\n  }\n  if (data) {\n    dataFetch.value = data.value;\n    console.log(dataFetch.value);\n    toast.add({ title: 'Artist created! Redirecting to Home...', timeout: 2000, callback:() => navigateTo('/home') })\n  }\n  }\n\n  function inputBlockedToggle() {\n    inputBlocked.value = !inputBlocked.value\n  }\n\n</script>\n\n<style scoped>\n\n.btn-clicked{\n  background-color: #bbf7d0;\n  color:#232c33;\n  padding: 10px 20px;\n    border: none;\n    border-radius: 20px;\n    cursor: pointer;\n}\n\n.input-blocked{\n  background-color: #232c33;\n  color: white;\n  cursor:not-allowed;\n}\n\n.title {\n    font-family: 'Garute';\n    font-size: 4rem;\n    font-weight: 800;\n    text-align: center;\n    padding: 3rem;\n}\n\n.main-container {\n    align-items: center;\n    justify-content: space-between;\n    width: 100%;\n}\n.form-container {\n    flex: 1;\n}\n\n.image-container {\n    max-width: 400px;\n    max-height: 400px;\n    overflow: hidden;\n    flex: 1;\n}\n\n  .artwork-form {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n  }\n\n  .form-label {\n    width: 100%;\n    max-width: 1000px;\n  }\n\n  .form-control {\n    width: 100%;\n    padding: 8px;\n    border: 1px solid #ccc;\n    border-radius: 20px;\n    margin-bottom: 10px;\n    box-sizing: border-box;\n  }\n\n  .btn {\n    padding: 10px 20px;\n    border: none;\n    border-radius: 20px;\n    background-color: #232c33;\n    color: #e1e9ec;\n    cursor: pointer;\n  }\n\n  .btn:hover {\n    background-color: #e1e9ec;\n    color: #232c33;\n  }\n</style>"],"names":["useRoute","toast","useToast","userLogged","storeToRefs","useAuthStore","pendingFetch","ref","avatar_image","inputBlocked","artist","user","dataFetch","skeletonOff","artistData","onBeforeMount","useUserLoggedData","onMounted","checkAvatar","error","watch","update","data","pending","useFetch","navigateTo","inputBlockedToggle"],"mappings":"k/CAoDcA,EAAU,EACxB,MAAMC,EAAQC,EAAQ,EAChB,CAAE,WAAAC,CAAY,EAAGC,EAAYC,EAAc,CAAA,EAC3CC,EAAeC,EAAI,EAAK,EACxBC,EAAeD,EAAI,EAAE,EACrBE,EAAeF,EAAI,EAAI,EACvBG,EAASH,EAAI,CACf,SAAU,EACd,CAAC,EACKI,EAAOJ,EAAI,CACb,WAAY,GACZ,UAAW,GACX,SAAS,GACT,MAAM,GACN,SAAS,GACT,OAAO,EACX,CAAC,EAEKK,EAAYL,EAAI,EAAE,EAClBM,EAAcN,EAAI,EAAK,EACvBO,EAAaP,EAAI,EAAE,EAEzBQ,EAAc,SAAW,CAEvBD,EAAW,MAAQ,MAAME,GAC3B,CAAC,EAEDC,EAAU,SAAY,CACpB,GAAI,CACFH,EAAW,MAAQ,MAAME,IACrBF,EAAW,QACXH,EAAK,MAAM,SAAWG,EAAW,MAAM,KAAK,SAC5CH,EAAK,MAAM,WAAaG,EAAW,MAAM,KAAK,WAC9CH,EAAK,MAAM,UAAYG,EAAW,MAAM,KAAK,UAC7CH,EAAK,MAAM,MAAQG,EAAW,MAAM,KAAK,MACzCH,EAAK,MAAM,OAASG,EAAW,MAAM,KAAK,OAC1CH,EAAK,MAAM,SAAWG,EAAW,MAAM,KAAK,SAC5CJ,EAAO,MAAM,SAAWI,EAAW,MAAM,UAE7CI,EAAa,EACbL,EAAY,MAAQ,EACrB,OAAQM,EAAO,CACd,QAAQ,MAAM,gCAAiCA,CAAK,CACrD,CACH,CAAC,EAEDC,EAAMT,EAAK,MAAO,IAAM,CAEtBO,IACA,QAAQ,IAAI,gBAAgB,CAC9B,CAAC,EAED,SAASA,GAAe,CAChBP,EAAK,MAAM,OAAO,SAAS,MAAM,EACjCH,EAAa,MAAQG,EAAK,MAAM,OAEhCH,EAAa,MAAQ,sGAE7B,CAEA,MAAMa,EAAS,SAAW,CACxB,KAAM,CAAE,KAAAC,EAAM,QAAAC,EAAS,MAAAJ,CAAO,EAAG,MAAMK,EAAS,iEAAiEV,EAAW,MAAM,EAAE,IAAK,CACvI,OAAQ,MACR,QAAS,CACP,eAAgB,kBAEjB,EACD,KAAM,KAAK,UAAU,CACjB,GAAIX,EAAW,MAAM,GACrB,SAAUQ,EAAK,MAAM,SACrB,MAAOA,EAAK,MAAM,MAClB,WAAYA,EAAK,MAAM,WACvB,UAAWA,EAAK,MAAM,UACtB,SAAUA,EAAK,MAAM,SACrB,OAAQA,EAAK,MAAM,OACnB,SAAUD,EAAO,MAAM,QAC/B,CAAK,CACF,EAAA,aAAA,EACGS,GACF,QAAQ,IAAIA,EAAM,KAAK,EAErBG,IACFV,EAAU,MAAQU,EAAK,MACvB,QAAQ,IAAIV,EAAU,KAAK,EAC3BX,EAAM,IAAI,CAAE,MAAO,yCAA0C,QAAS,IAAM,SAAS,IAAMwB,EAAW,OAAO,CAAC,CAAE,EAEjH,EAED,SAASC,GAAqB,CAC5BjB,EAAa,MAAQ,CAACA,EAAa,KACpC"}