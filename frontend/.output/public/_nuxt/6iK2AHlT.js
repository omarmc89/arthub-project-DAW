import{u as s}from"./C0_R-043.js";import{aq as l,ar as o}from"./C79j48wv.js";const h=l("auth",{state:()=>({authenticated:!1,loading:!1,userEmailLogged:"",userLogged:"",sessionToken:"",artistId:""}),actions:{async authenticateUser({email:e,password:t}){const{data:a,error:i,pending:r}=await s("https://arthub-api-polished-breeze-902.fly.dev/api/v1/auth/login/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})},"$L7GOUGH2Ei");if(this.loading=r,a.value){const n=o("token");n.value=a.value.key,this.authenticated=!0,this.userEmailLogged=e,this.sessionToken=a.value.key,localStorage.setItem("token",a.value.key)}return this.getUserID(),{data:a.value,error:i.value}},async getUserID(){const{data:e}=await s("https://arthub-api-polished-breeze-902.fly.dev/api/v1/auth/user/",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Token ${localStorage.getItem("token")}`}},"$9tIGMbEnCX");if(e.value){const t={...e.value};this.userLogged=t,localStorage.setItem("userId",e.value.pk),this.getArtistId()}},async getArtistId(){const{data:e}=await s(`https://arthub-api-polished-breeze-902.fly.dev/api/v1/search/artist/?user_id=${this.userLogged.pk}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Token ${localStorage.getItem("token")}`}},"$vHZDuP3yg3");if(e.value){const t=e.value;this.artistId=t.id,localStorage.setItem("artistID",e.value.id)}},logout(){const e=o("token");this.authenticated=!1,e.value=null,this.userEmailLogged=null,this.userLogged=null,this.sessionToken=null,this.artistId=null,localStorage.removeItem("token"),localStorage.removeItem("userId")}},persist:!0});export{h as u};
//# sourceMappingURL=6iK2AHlT.js.map
